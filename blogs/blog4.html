<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<link rel="icon" href="assets/img/favicon.ico">
<title>It's me AnonArtist</title>
<!-- Bootstrap core CSS -->
<link href="assets/css/bootstrap.min.css" rel="stylesheet">
<!-- Fonts -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
<!-- Custom styles for this template -->
<link href="assets/css/mediumish.css" rel="stylesheet">
</head>
<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<!-- Begin Menu -->
		<ul class="navbar-nav ml-auto">
			<li class="nav-item active">
			<a class="nav-link" href="https://itsmeanonartist.tech/#header">Home <span class="sr-only">(current)</span></a>
			</li>
			<li class="nav-item">
			<a class="nav-link" href="https://itsmeanonartist.tech/#services">Blogs</a>
			</li>
		</ul>
		<!-- End Menu -->
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->

<!-- Begin Article
================================================== -->
<div class="container">
	<div class="row">

		<!-- Begin Post -->
		<div class="col-md-8 col-md-offset-2 col-xs-12">
			<div class="mainheading">

				<h1 class="posttitle" style="color:green">Cyberdome Kozhikode CTF 2021 Writeup</h1>

			</div>

			<!-- Begin Post Content -->
			<div class="article-post">
				<p>
					Cyberdome Kozhikode organized this year's cyber security conference 'Cyber Security Summit 2021' virtually on Feb 27th and Feb 28th. On behalf of the summit, we conducted a Capture The Flag (CTF) event.<br>Here is a brief writeup about the challenge that I had contributed in for the event.
				</p>
				<p style="color:red"><b>The Serial Killer</b></p>
				Let's check how to solve <b>The Serial Killer</b>, which is a web challenge<br>Here is the description:<br><img src="blog4/tskdesc.png" width="100%" height="auto"><br>The description and challenge name contain some hints, let's check it out.<br><img src="blog4/tskdesced.png" width="100%" height="auto"><br>The challenge name and <br><img src="blog4/challengedatax.png" width="100%" height="auto"><br>contents inside the challenge gives us an idea that it is based on deserialization, Now let's check the page using 'view page source'<br><img src="blog4/source.png" width="100%" height="auto"><br>It says <b>Todo: Update Yaml Parser.</b> Now we can conclude that its a PyYAML deserialization bug.Just googling this gives us a lot of informations.<br><blockquote>Me and my friends <a href="https://twitter.com/odinshell" style="color:red">Asjid Kalam</a>, <a href="https://twitter.com/b3ef_" style="color:red">Ajmal Aboobacker</a> and <a href="https://twitter.com/b1nslashsh" style="color:red">Abdul Muhaimin</a> widely exploited this bug and found a lot of zero days in reputed organizations/firms/individuals such as Microsoft, Google, Tensorflow, Facebook Research, Nvidia, Spotify, etc and reported in <a href="https://www.huntr.dev/" style="color:red">Huntr.dev</a></blockquote><iframe src="https://giphy.com/embed/l4EpkVLqUj8BI7OV2" width="250" height="200" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><br><b>So here i tried to recreate that scenario, You will see a blog about that soon but let's leave it at that for now and let's come back to the challenge.</b><br>Here is a problem we face that whenever we giving the payload it gives a 500 error<br><img src="blog4/error.png" width="100%" height="auto"><br>But reading the contents inside the error gives us a hope that it is intentional and we can assume that the code execution is happening blindly.<br>So we need to take a reverse shell which is the best way to solve it. To do this, create a malicious yaml file to execute a python reverse shell and read the flag from it.<img src="blog4/exp.png" width="100%" height="auto"><br>Now just create a ngrok tcp tunnel and replace the ip in the malicious yaml with ngrok link and ngrok port.<br>Now convert it into base64 because the challenge says it will only accept base64 code.<br>Before that, setup a netcat listener to get the reverse shell.<br><img src="blog4/output3.png" width="100%" height="auto"><br>Whoa, we got the reverse shell as root and inside /home directory, we can see the flag<br><iframe src="https://giphy.com/embed/ASvQ3A2Q7blzq" width="200" height="200" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><br><br>Thanks to <a href="https://twitter.com/cyberdome_kkd" style="color:red">Kozhikode Cyberdome</a>, <a href="https://twitter.com/zealabs" style="color:red">Team Zealabs</a> and <a href="https://twitter.com/yetanothersec" style="color:red">YAS Community</a> for giving this opportunity and
          <br><br><br>
<center><b>THANK YOU For Reading my blog post</b></center><br></p><br>
        </div>
			<!-- End Post Content -->

			<!-- Begin Tags -->
			<div class="after-post-tags">
				<ul class="tags">
				    <li><a href="#">Anon-Artist</a></li>
					<li><a href="#">CTF</a></li>
					<li><a href="#">Zero Day</a></li>
					<li><a href="#">Python Deserialization</a></li>
					<li><a href="#">Kerala Police</a></li>
				</ul>
			</div>
			<!-- End Tags -->

		</div>
		<!-- End Post -->

	</div>
</div>
<!-- End Article
================================================== -->

<div class="hideshare"></div>

<!-- Begin Footer
================================================== -->
<div class="container">
	<div class="footer">
		<p class="pull-right">
			 Made with ❤️ Anon-Artist
		</p>
		<div class="clearfix">
		</div>
	</div>
</div>
<!-- End Footer
================================================== -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="assets/js/mediumish.js"></script>
</body>
</html>
